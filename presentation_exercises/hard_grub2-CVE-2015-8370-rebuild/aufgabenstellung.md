# Aufgabenstellung CVE-2015-8370
## Szenario

Dies ist eine bereits veröffentlichte Sicherheitslücke im `grub2` bootloader.
Diese ermöglichte es einem Angreifer eine Revocery Shell auf dem System zu
öffnen. Mittels der Recovery Shell ist es möglich, die Boot-Einträge zu
manipulieren. Darüber konnte man einen Root-Zugang erlangen.

## Aufgabenstellung

Finden Sie die Stelle, welche ausgenutzt wurde.

## Dokumentation
Wie man in dem Programm sehen kann, ist es möglich, durch mehrfaches Drücken
der Backspace-Taste einen Integer-Underflow zu verursachen, wenn man den
Benutzernamen oder das Passwort eingibt. Im offiziellen Fall, das heißt der
CVE-2015-8370, war eine Lücke von 1998 bis 2015 gegeben, die bei 28-maligem
Drücken der Enter-Taste ermöglichte, dass der Rechner neustartet und in der
Grub Rescue Shell landet. In dieser konnte man dann auch geschützte Partitionen
ohne Eingabe des Kennworts booten und sogar zusätzlich als Root Zugriff auf das
komplette Dateisystem erhalten. Somit ist es möglich, sämtliche Malware auf dem
System einzurichten, den eigentlichen Benutzer auszusperren oder an geheime
Dokumente zu gelangen. Auch in dem hier gezeigten Programm, welches eine
Nachbildung ist, findet man die Schwäche, da nicht geprüft wird, ob `cur_len`,
welches die aktuelle Position des Zeigers für die Puffer-Variable darstellt,
negativ wird. "0" bedeutet, dass alle Buchstaben, welche man eingab, wieder
gelöscht wurden. Eigentlich sollte hier kein Underflow stattfinden, das heißt
`cur_len` sollte niemals negativ werden. Das Dekrementieren funktioniert jedoch
trotzdem. Da danach die memset-Methode aufgerufen wird, um alles nach den
Eingaben auf Nullen zu setzen (an sich ein sicheres Vorgehen, da man so
Eingaben wie `test\0Shellcode` verhindern kann), sorgt man aber dafür, dass man
schon vor der Puffer-Variable damit beginnen kann auf Nullen zu setzen. Genau
dadurch erreicht man den Rücksprung an die Adresse 0x0 (im offiziellen Fall)
oder kann auch andere Variablen auf dem Stack manipulieren und dadurch den
Programmablauf steuern, so dass man als Angreifer Zugang zum System erhalten
kann.
